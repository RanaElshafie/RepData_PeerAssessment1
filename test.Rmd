---
title: "Untitled"
author: "Rana"
date: "7/26/2020"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
# Load the data 
a <- read.csv("activity.csv", header = TRUE)
#Aggregating(summation) of steps over date
aggsteps<- aggregate(steps ~ date, a, FUN=sum)

#Aggregated Data (all steps added for a particular date)
head(aggsteps)
#Ploting histogram from Base Plotting
hist(aggsteps$steps, 
     col="red", 
     xlab = "Frequency", 
     ylab = "Steps",
     main = "Total Number Of Steps Taken Each day")
amean <- mean(aggsteps$steps)
amedian <- median(aggsteps$steps)

#Mean total number of steps taken per day
amean

#Median total number of steps taken per day
amedian

agginterval <- aggregate(steps ~ interval, a, FUN=sum)

#Plotting line graph using plot() from Base Plotting for Total Steps vs 5-Minute Interval
plot(agginterval$interval, agginterval$steps, 
     type = "l", lwd = 2,
     xlab = "Interval", 
     ylab = "Total Steps",
     main = "Total Steps vs. 5-Minute Interval")
filter(agginterval, steps==max(steps))
table(is.na(a))

#In the original data set aggregating (mean) steps over 5-minute interval
meaninterval<- aggregate(steps ~ interval, a, FUN=mean)

#Merging the mean of total steps for a date with the original data set
anew <- merge(x=a, y=meaninterval, by="interval")

#Replacing the NA values with the mean for that 5-minute interval
anew$steps <- ifelse(is.na(anew$steps.x), anew$steps.y, anew$steps.x)

#Merged dataset which will be subsetted in the next step by removing not required columns
head(anew)
#Fetching only the required columns (steps, date, interval) and storing in the new data set.
anew <- select(anew, steps, date, interval)

#New dataset with NA imputed by mean for that 5-minute interval
head(anew)

aggsteps_new<- aggregate(steps ~ date, anew, FUN=sum)

#Plotting
#Setting up the pannel for one row and two columns
par(mfrow=c(1,2))

#Histogram after imputing NA values with mean of 5-min interval
hist(aggsteps_new$steps, 
     col="green",
     xlab = "Steps", 
     ylab = "Frequency",
     ylim = c(0,35),
     main = "Total Number Of Steps Taken Each day \n(After imputing NA values with \n mean of 5-min interval)",
     cex.main = 0.7)

#Histogram with the orginal dataset
hist(aggsteps$steps, 
     col="red", 
     xlab = "Steps", 
     ylab = "Frequency",
     ylim = c(0,35),
     main = "Total Number Of Steps Taken Each day \n(Orginal Dataset)",
     cex.main = 0.7)

ar(mfrow=c(1,1)) #Resetting the panel

amean_new <- mean(aggsteps_new$steps)
amedian_new <- median(aggsteps_new$steps)

#Comparing Means
paste("New Mean      :", round(amean_new,2), "," ,  
      " Original Mean :", round(amean,2),"," , 
      " Difference :",round(amean_new,2) -  round(amean,2))


paste("New Median    :", amedian_new, ",", 
      " Original Median :", amedian,"," , 
      " Difference :",round(amedian_new-amedian,2))

table(is.weekend(anew$date))

#Adding new factor variable "dayofweek" indicating whether a given date is a weekday or weekend day
anew$dayofweek <- ifelse(is.weekend(anew$date), "weekend", "weekday")

#Number of Weekdays and Weekends
table(anew$dayofweek)
head(anew)

#Aggregating(mean) steps over interval and day of week
meaninterval_new<- aggregate(steps ~ interval + dayofweek, anew, FUN=mean)

#Aggregated Data
head(meaninterval_new)


ggplot(meaninterval_new, aes(x=interval, y=steps)) + 
  geom_line(color="blue", size=1) + 
  facet_wrap(~dayofweek, nrow=2) +
  labs(x="\nInterval", y="\nNumber of steps")

```



